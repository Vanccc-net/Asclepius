# Asclepius.Auth - Сервис аутентификации и управления профилями (Микросервисная архитектура)

##  Обзор проекта

**Asclepius.Auth** — это высоконадежный, распределенный сервис аутентификации, разработанный в парадигме **Микросервисов**. Он отвечает за регистрацию, аутентификацию пользователей, генерацию JWT-токенов и асинхронную рассылку уведомлений и создания профиля.

Проект построен с использованием **Чистой Архитектуры (Clean Architecture / Onion Architecture)** и принципов **Domain-Driven Design (DDD)**, что обеспечивает высокую масштабируемость и поддерживаемость.

##  Архитектура и основные технологии

### Основные принципы:

* **Чистая Архитектура / DDD:** Строгое разделение на слои Домена, Бизнес-логики, Представления и Инфраструктуры. Использование **Объектов-Значений (Value Objects)**, **Фабричных методов** и **Репозиториев**.
* **Паттерн Mediator:** Использование **MediatR** для отделения HTTP-контроллеров от основной бизнес-логики (`AuthController` лишь отправляет команды).
* **Транзакционная надежность:** Применение **Unit of Work** для обеспечения атомарности транзакций и **Transactional Outbox Pattern (через MassTransit)** для гарантии доставки асинхронных сообщений.

### Технологический стек:

| Стек | Технология | Назначение |
| :--- | :--- | :--- |
| **Backend** | .NET 8 (C#) | Основной фреймворк |
| **База данных** | PostgreSQL, Entity Framework Core | Хранение пользователей и ролей |
| **Кэширование** | Redis | Хранение рефреш-токенов / данных сессий |
| **Обмен сообщениями**| MassTransit (RabbitMQ / Kafka) | Асинхронная коммуникация между микросервисами |
| **CI/CD** | Docker / Docker Compose | Контейнеризация и оркестрация |
| **Мониторинг** | Prometheus, Grafana, Serilog | Сбор метрик, визуализация и структурированное логирование |

##  Как запустить проект

Проект полностью контейнеризован и запускается одной командой с помощью Docker Compose.

**Предварительные условия:**

1.  Установлен Docker и Docker Compose.

**Запуск:**

1.  Перейдите в корневую директорию проекта, где находится файл `docker-compose.yml`.
2.  Выполните команду:
    ```bash
    docker-compose up --build -d
    ```

Процесс займет несколько минут, поскольку будет собрано 3+ сервисов.

### Конечные точки:

| Сервис | Порт | Адрес | Описание |
| :--- | :--- | :--- | :--- |
| **Auth API (Swagger)** | `http://localhost:8080` | `/` | Главный API, документация и тесты |
| **Grafana** | `http://localhost:3000` | | Панель мониторинга метрик |
| **RabbitMQ** | `http://localhost:15672` | `guest/guest` | UI для управления очередями |

##  Точки внимания (для оценки)

Я бы хотел обратить особое внимание на следующие архитектурные решения:

1.  **UserController:** Максимально "тонкий" контроллер. Он не содержит бизнес-логики, а лишь отправляет команды через `IMediator`.
2.  **Password Value Object:** Логика хеширования пароля (BCrypt) инкапсулирована в `Domain/UserObject/Password.cs`, обеспечивая гарантию валидности и безопасности.
3.  **ApplicationContext:** Использование **Value Converters** для сохранения `Value Objects` и подключение **Transactional Outbox** для надежности сообщений.
4.  **Unit Tests (в работе):** Для Command Handlers используются **xUnit** и **Moq** для тестирования бизнес-логики в изоляции от инфраструктуры.